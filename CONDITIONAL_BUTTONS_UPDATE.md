# 条件显示快捷按钮更新

## 🎯 更新需求

根据用户反馈，快捷按钮（Today/Yesterday/Tomorrow）应该只在选中今天的日期时显示，其他日期不需要显示这些按钮。

## ✅ 实现方案

### 1. 显示逻辑

**条件判断**：
```javascript
// 检查选中的日期是否为用户时区的今天
const now = new Date();
const todayInTimezone = utcToZonedTime(now);
const selectedInTimezone = utcToZonedTime(selectedDate);

// 比较日期部分（忽略时间）
const isSelectedToday = 
  todayInTimezone.getFullYear() === selectedInTimezone.getFullYear() &&
  todayInTimezone.getMonth() === selectedInTimezone.getMonth() &&
  todayInTimezone.getDate() === selectedInTimezone.getDate();
```

**显示规则**：
- ✅ 当选中日期 = 用户时区的今天 → 显示快捷按钮
- ❌ 当选中日期 ≠ 用户时区的今天 → 隐藏快捷按钮

### 2. 组件修改

#### DateTimeInput 组件
```tsx
{/* 快捷选择按钮 - 只在选中今天时显示 */}
{(() => {
  const isSelectedToday = /* 判断逻辑 */;
  
  return isSelectedToday ? (
    <div className="flex gap-1.5">
      {/* Today/Yesterday/Tomorrow 按钮 */}
    </div>
  ) : null;
})()}
```

#### EnhancedDatePicker 组件
```tsx
{/* 快捷选择 - 只在选中今天时显示 */}
{(() => {
  const isSelectedToday = /* 判断逻辑 */;
  
  return isSelectedToday ? (
    <div className="p-4 border-b border-gray-100 dark:border-gray-700">
      {/* 快捷按钮区域 */}
    </div>
  ) : null;
})()}
```

## 🎨 用户体验改进

### 修改前
- 快捷按钮始终显示在所有日期
- 可能造成用户困惑：为什么在查看历史日期时还有"Today"按钮？
- 界面元素冗余

### 修改后
- ✅ 快捷按钮只在相关时显示
- ✅ 界面更简洁，减少视觉干扰
- ✅ 逻辑更直观：只有在今天才需要快速切换到昨天/明天
- ✅ 符合用户心理模型

## 🔧 技术实现细节

### 1. 时区处理
- 使用用户选择的时区进行日期比较
- 确保"今天"的判断基于用户时区而非浏览器时区
- 只比较日期部分，忽略具体时间

### 2. 性能考虑
- 使用立即执行函数表达式 (IIFE) 进行条件渲染
- 避免不必要的组件重新渲染
- 日期比较逻辑简单高效

### 3. 代码结构
- 保持组件逻辑清晰
- 条件渲染逻辑封装在函数中
- 易于维护和测试

## 📱 使用场景

### 场景 1：选中今天
- **状态**：用户选择了今天的日期
- **显示**：Today/Yesterday/Tomorrow 按钮可见
- **用途**：快速切换到相邻日期

### 场景 2：选中历史日期
- **状态**：用户选择了过去的日期（如上周）
- **显示**：快捷按钮隐藏
- **原因**：用户专注于查看历史数据，不需要快速切换

### 场景 3：选中未来日期
- **状态**：用户选择了未来的日期
- **显示**：快捷按钮隐藏
- **原因**：用户在规划未来，不需要快速回到今天

## 🎯 设计原则

### 1. 上下文相关性
- 功能按钮只在相关上下文中显示
- 减少界面噪音和认知负担

### 2. 用户意图导向
- 当用户查看今天时，可能需要快速比较昨天/明天
- 当用户查看其他日期时，专注于该日期的信息

### 3. 界面简洁性
- 避免不必要的界面元素
- 保持视觉焦点在主要内容上

## 📊 对比效果

| 方面 | 修改前 | 修改后 |
|------|--------|--------|
| 界面简洁度 | 中等 | 高 |
| 用户困惑度 | 可能困惑 | 清晰直观 |
| 功能相关性 | 低（在历史日期显示Today） | 高（只在相关时显示） |
| 视觉干扰 | 有干扰 | 最小化 |
| 用户体验 | 一般 | 优秀 |

## 🚀 部署说明

### 1. 向后兼容
- 功能逻辑保持不变
- 只是显示条件发生变化
- 不影响现有用户的使用习惯

### 2. 用户教育
- 在演示页面添加说明
- 文档中明确说明新的显示逻辑

### 3. 测试要点
- 验证在不同日期选择下的按钮显示/隐藏
- 确保时区切换时逻辑正确
- 测试边界情况（跨日期边界）

## 🎉 总结

这个更新让日历组件的界面更加智能和简洁：
- ✅ 快捷按钮只在需要时显示
- ✅ 减少界面干扰和用户困惑
- ✅ 提升整体用户体验
- ✅ 保持功能完整性

用户现在可以享受到更加直观和简洁的日期选择体验！